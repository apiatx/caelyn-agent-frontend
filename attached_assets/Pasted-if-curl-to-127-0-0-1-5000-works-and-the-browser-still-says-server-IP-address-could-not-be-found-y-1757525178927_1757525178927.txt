if curl to 127.0.0.1:5000 works and the browser still says “server IP address could not be found,” your code is fine. The URL/preview plumbing is borked. Here’s a bulletproof recovery that doesn’t rely on the agent guessing.

Phase 1 — Prove the router with a dead-simple server

In the Shell, create a tiny server:

printf '%s\n' "import http from 'http';
const port = Number(process.env.PORT || 5000);
http.createServer((_,res)=>{res.end('ok')}).listen(port,'0.0.0.0',()=>console.log('listening',port));
" > sanity.mjs


Open .replit and make it minimal. Delete any [[ports]] stuff entirely for now and set just:

run = "node sanity.mjs"


Save.

Click Stop then Run.

In Preview, click the globe icon → Open in new tab.

If the new tab shows ok, routing works. The issue was your config/URL, not Replit networking.

If you still get “could not be found,” you’re hitting a stale hostname. Keep going.

Phase 2 — Force a fresh, correct URL

Do one of these that always works:

In Preview, click the dropdown next to the globe and choose Copy external URL. Paste that into a brand-new browser tab or an incognito window.

If the URL contains kirk.replit.dev, it’s likely stale. Replit’s current live domains are usually *.repl.co. Use whatever the globe gives you now, not an old bookmark.

From the Shell, test the external URL directly:

# paste the exact URL from the globe:
curl -I "https://<the-url-you-just-opened>"


If DNS fails here, the URL is wrong — grab it again from the globe.

Phase 3 — Put your real app back

Once the sanity server works:

Restore .replit to a clean, safe config. Don’t overthink ports — Replit auto-routes to $PORT.

Node/TS (tsx) example:

run = "node --loader tsx server/index.ts"


Or:

run = "npm run dev"


Do not add any [[ports]] blocks yet. Let Preview auto-detect.

Make sure your server binds correctly in code:

const port = Number(process.env.PORT || 5000);
const host = '0.0.0.0';
app.listen(port, host, () => console.log('listening', port));


Stop → Run → Globe → Open in new tab. Use that URL only.

If it’s still busted after all that

This means the repl’s external hostname mapping is wedged. Two fast escapes:

Fork the repl:
Replit menu → Fork. Open the fork, hit Run, use the fork’s globe URL. Fresh domain, clean routing.

Nuke the custom port map:
Completely remove every [[ports]] block. They’re optional and frequently the cause of weirdness. Replit will route whatever $PORT your server binds to without them.

Quick sanity checks

Local works?
curl -sS http://127.0.0.1:$PORT/ | head should return your content.

External works?
The globe URL should load; don’t reuse anything with kirk.replit.dev from history.

Browser issue?
Try an incognito window or disable VPN/ad-blockers just to test.

DNS cache on Mac?

sudo dscacheutil -flushcache; sudo killall -HUP mDNSResponder


If you paste your current .replit and the first ~15 lines of server/index.ts, I’ll give you the exact working .replit and start line. We’ll make this thing purr like a well-oiled pipeline.